{% extends "admin_page.html" %}
{% load i18n %}

{% block adminmodule %}
<h2>{% trans "Firewall configuration" %}</h2>

<!-- FORWARD CHAIN -->
<h3>{% trans "Traffic forwarding rules" %}</h3>
<table>
<tr>
	<th>{% trans "From" %} </th>
	<th> &nbsp;</th>
	<th>{% trans "To" %}</th>
	<th>&nbsp;</th>
	<th>{% trans "Options" %}</th>
	<th>{% trans "Action" %}</th>
</tr>
{% for rule in forward %}
<tr>
	<td>{{ rule.i }}</td>
	<td>{{ rule.s }}</td>
	<td>{{ rule.o }}</td>
	<td>{{ rule.d }}</td>
	<td>{{ rule.rest }}</td>
	<td>{{ rule.j }}</td>
</tr>
{% empty %}
</table>
<p>{% trans "No rules present." %}</p>
<table>
{% endfor %}


</table>

<!-- INPUT CHAIN -->
<h3>{% trans "Server rules" %}</h3>
<table>
<tr>
	<th>{% trans "From" %} </th>
	<th> &nbsp;</th>
	<th>{% trans "To" %}</th>
	<th>&nbsp;</th>
	<th>{% trans "Options" %}</th>
	<th>{% trans "Action" %}</th>
</tr>
{% for rule in input %}
<tr>
	<td>{{ rule.i }}</td>
	<td>{{ rule.s }}</td>
	<td>{{ rule.o }}</td>
	<td>{{ rule.d }}</td>
	<td>{{ rule.rest }}</td>
	<td>{{ rule.j }}</td>
</tr>
{% empty %}
</table>
<p>{% trans "No rules present." %}</p>
<table>
{% endfor %}
</table>
<form action="/admin/firewall" method="post"> {% csrf_token %}
<table>
	<tr>
		<th>{% trans "SRC IP" %}</th>
		<th>{% trans "SRC P" %}</th>
		<th>{% trans "DST IP" %}</th>
		<th>{% trans "DST P" %}</th>
		<th>{% trans "J" %}</th>
		<th></th>
	</tr>
	<tr>
		<td>{{ form.src_ipÂ }} / {{ form.src_subnet }}</td>
		<td>{{ form.src_port }}</td>
		<td>{{ form.dst_ip }} / {{ form.dst_subnet }}</td>
		<td>{{ form.dst_port }}</td>
		<td>{{ form.action }}</td>
		<td><input type="submit" value="{% trans "add" %}"></td>
	</tr>
</table>
</form>

{% endblock %}